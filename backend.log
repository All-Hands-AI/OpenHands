DEBUG:openhands:DEBUG mode enabled.
[92m00:58:32 - openhands:DEBUG[0m: logger.py:384 - Logging initialized
[92m00:58:32 - openhands:DEBUG[0m: logger.py:396 - Logging to file in: /workspace/OpenHands/logs
[92m00:58:32 - openhands:DEBUG[0m: sandbox_config.py:60 - SandboxConfig user_id default: annotation=NoneType required=False default=0
2025-09-04 00:58 - openhands_aci:DEBUG - Logger initialized
2025-09-04 00:58 - openhands_aci.editor.file_cache:DEBUG - Current size updated: 0
2025-09-04 00:58 - openhands_aci.editor.file_cache:DEBUG - FileCache initialized with directory: /tmp/oh_editor_history_6r3owywn, size_limit: None, current_size: 0
[92m00:58:35 - openhands:INFO[0m: server_config.py:54 - Using config class None
[92m00:58:35 - openhands:DEBUG[0m: file_config.py:80 - File upload config: max_size=0MB, restrict_types=False, allowed_extensions=['.*']
INFO:     Started server process [6975]
INFO:     Waiting for application startup.
[92m00:58:36 - openhands:DEBUG[0m: shutdown_listener.py:47 - _register_signal_handlers
[92m00:58:36 - openhands:DEBUG[0m: shutdown_listener.py:51 - _register_signal_handlers:main_thread
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:3000 (Press CTRL+C to quit)
INFO:     127.0.0.1:35980 - "GET /api/health HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:35984 - "GET /health HTTP/1.1" 200 OK
[92m01:08:31 - openhands:WARNING[0m: file_conversation_store.py:90 - Could not load conversation metadata: c941ba54-819c-41cf-9db5-0681a9a0f79a
[92m01:08:31 - openhands:WARNING[0m: file_conversation_store.py:90 - Could not load conversation metadata: 34f2994f-78ab-4a2b-aa5c-cd5fb41e006b
INFO:     127.0.0.1:38342 - "GET /api/conversations HTTP/1.1" 200 OK
[92m01:09:07 - openhands:WARNING[0m: file_conversation_store.py:90 - Could not load conversation metadata: c941ba54-819c-41cf-9db5-0681a9a0f79a
[92m01:09:07 - openhands:WARNING[0m: file_conversation_store.py:90 - Could not load conversation metadata: 34f2994f-78ab-4a2b-aa5c-cd5fb41e006b
INFO:     127.0.0.1:39040 - "GET /api/conversations HTTP/1.1" 200 OK
INFO:     127.0.0.1:57046 - "POST /api/conversations/181b1f09ae3048afa7438dd9ae79c173/reset HTTP/1.1" 422 Unprocessable Entity
[92m01:09:25 - openhands:INFO[0m: manage_conversations.py:612 - Resetting conversation: 181b1f09ae3048afa7438dd9ae79c173
[92m01:09:25 - openhands:INFO[0m: conversation_service.py:48 - New conversation ID: ba9c4219c23a48849037ce9a1ec69cc5
[92m01:09:25 - openhands:INFO[0m: conversation_service.py:55 - Saving metadata for conversation ba9c4219c23a48849037ce9a1ec69cc5
[92m01:09:25 - openhands:INFO[0m: conversation_service.py:90 - Creating conversation
[92m01:09:25 - openhands:INFO[0m: conversation_service.py:98 - Loading settings
[92m01:09:25 - openhands:INFO[0m: conversation_service.py:101 - Settings loaded
[92m01:09:25 - openhands:INFO[0m: conversation_service.py:136 - Starting agent loop for conversation ba9c4219c23a48849037ce9a1ec69cc5
[92m01:09:25 - openhands:INFO[0m: standalone_conversation_manager.py:288 - maybe_start_agent_loop:ba9c4219c23a48849037ce9a1ec69cc5
[92m01:09:25 - openhands:INFO[0m: standalone_conversation_manager.py:304 - starting_agent_loop:ba9c4219c23a48849037ce9a1ec69cc5
[92m01:09:25 - openhands:INFO[0m: llm_registry.py:87 - [LLM registry 2cb0bc91-b7bd-4bad-b94f-458a978f0878]: Registering service for agent
[92m01:09:25 - openhands:INFO[0m: llm.py:444 - No data field in model info response from LiteLLM proxy: {'detail': 'Not Found'}
[92m01:09:25 - openhands:DEBUG[0m: llm.py:483 - Model info: {
  "model": "litellm_proxy/openrouter/moonshotai/kimi-k2:free",
  "base_url": "http://172.17.0.1:4001/v1"
}
[92m01:09:25 - openhands:INFO[0m: conversation_service.py:155 - Finished initializing conversation ba9c4219c23a48849037ce9a1ec69cc5
[92m01:09:25 - openhands:WARNING[0m: manage_conversations.py:698 - Error handling container rename: Error while fetching server API version: ('Connection aborted.', ConnectionRefusedError(111, 'Connection refused')), will proceed with new container
[92m01:09:25 - openhands:DEBUG[0m: event_store.py:72 - No events found for session ba9c4219c23a48849037ce9a1ec69cc5 at sessions/ba9c4219c23a48849037ce9a1ec69cc5/events/
[92m01:09:25 - openhands:DEBUG[0m: session.py:164 - MCP configuration before setup - self.config.mcp_config: sse_servers=[] stdio_servers=[] shttp_servers=[]
[92m01:09:25 - openhands:DEBUG[0m: session.py:173 - Merged custom MCP Config: sse_servers=[] stdio_servers=[] shttp_servers=[]
[92m01:09:25 - openhands:WARNING[0m: mcp_config.py:331 - No search engine API key found, skipping search engine
[92m01:09:25 - openhands:DEBUG[0m: session.py:184 - Added default MCP HTTP server to config
[92m01:09:25 - openhands:DEBUG[0m: session.py:188 - MCP configuration after setup - self.config.mcp: sse_servers=[] stdio_servers=[] shttp_servers=[MCPSHTTPServerConfig(url='http://localhost:3000/mcp/mcp', api_key='******')]
[92m01:09:25 - openhands:INFO[0m: session.py:219 - Enabling pipeline condenser with: browser_output_masking(attention_window=2),  llm(model="litellm_proxy/openrouter/moonshotai/kimi-k2:free",  base_url="http://172.17.0.1:4001/v1",  keep_first=4, max_size=120)
[92m01:09:25 - openhands:INFO[0m: llm_registry.py:87 - [LLM registry 2cb0bc91-b7bd-4bad-b94f-458a978f0878]: Registering service for condenser
[92m01:09:25 - openhands:INFO[0m: llm.py:444 - No data field in model info response from LiteLLM proxy: {'detail': 'Not Found'}
[92m01:09:25 - openhands:DEBUG[0m: llm.py:483 - Model info: {
  "model": "litellm_proxy/openrouter/moonshotai/kimi-k2:free",
  "base_url": "http://172.17.0.1:4001/v1"
}
[92m01:09:25 - openhands:DEBUG[0m: codeact_agent.py:93 - Using condenser: <class 'openhands.memory.condenser.impl.pipeline.CondenserPipeline'>
[92m01:09:25 - openhands:DEBUG[0m: agent_session.py:322 - Initializing runtime `docker` now...
[92m01:09:25 - openhands:ERROR[0m: docker_runtime.py:256 - Launch docker client failed. Please make sure you have installed docker and started docker desktop/daemon.
Traceback (most recent call last):
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/openhands/micromamba/envs/openhands/lib/python3.12/http/client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/openhands/micromamba/envs/openhands/lib/python3.12/http/client.py", line 1093, in _send_output
    self.send(msg)
  File "/openhands/micromamba/envs/openhands/lib/python3.12/http/client.py", line 1037, in send
    self.connect()
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/docker/transport/unixconn.py", line 26, in connect
    sock.connect(self.unix_socket)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/requests/adapters.py", line 667, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/urllib3/util/retry.py", line 474, in increment
    raise reraise(type(error), error, _stacktrace)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/urllib3/util/util.py", line 38, in reraise
    raise value.with_traceback(tb)
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/openhands/micromamba/envs/openhands/lib/python3.12/http/client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/openhands/micromamba/envs/openhands/lib/python3.12/http/client.py", line 1093, in _send_output
    self.send(msg)
  File "/openhands/micromamba/envs/openhands/lib/python3.12/http/client.py", line 1037, in send
    self.connect()
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/docker/transport/unixconn.py", line 26, in connect
    sock.connect(self.unix_socket)
urllib3.exceptions.ProtocolError: ('Connection aborted.', ConnectionRefusedError(111, 'Connection refused'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/docker/api/client.py", line 223, in _retrieve_server_version
    return self.version(api_version=False)["ApiVersion"]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/docker/api/daemon.py", line 181, in version
    return self._result(self._get(url), json=True)
                        ^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/docker/utils/decorators.py", line 44, in inner
    return f(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/docker/api/client.py", line 246, in _get
    return self.get(url, **self._set_request_timeout(kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/requests/sessions.py", line 602, in get
    return self.request("GET", url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/requests/adapters.py", line 682, in send
    raise ConnectionError(err, request=request)
requests.exceptions.ConnectionError: ('Connection aborted.', ConnectionRefusedError(111, 'Connection refused'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspace/OpenHands/openhands/runtime/impl/docker/docker_runtime.py", line 254, in _init_docker_client
    return docker.from_env()
           ^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/docker/client.py", line 94, in from_env
    return cls(
           ^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/docker/client.py", line 45, in __init__
    self.api = APIClient(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/docker/api/client.py", line 207, in __init__
    self._version = self._retrieve_server_version()
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/docker/api/client.py", line 230, in _retrieve_server_version
    raise DockerException(
docker.errors.DockerException: Error while fetching server API version: ('Connection aborted.', ConnectionRefusedError(111, 'Connection refused'))
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/workspace/OpenHands/openhands/server/__main__.py", line 20, in <module>
    main()
  File "/workspace/OpenHands/openhands/server/__main__.py", line 11, in main
    uvicorn.run(
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/uvicorn/main.py", line 580, in run
    server.run()
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/uvicorn/server.py", line 67, in run
    return asyncio.run(self.serve(sockets=sockets))
  File "/openhands/micromamba/envs/openhands/lib/python3.12/asyncio/runners.py", line 195, in run
    return runner.run(main)
  File "/openhands/micromamba/envs/openhands/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/openhands/micromamba/envs/openhands/lib/python3.12/asyncio/base_events.py", line 678, in run_until_complete
    self.run_forever()
  File "/openhands/micromamba/envs/openhands/lib/python3.12/asyncio/base_events.py", line 645, in run_forever
    self._run_once()
  File "/openhands/micromamba/envs/openhands/lib/python3.12/asyncio/base_events.py", line 1999, in _run_once
    handle._run()
  File "/openhands/micromamba/envs/openhands/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/workspace/OpenHands/openhands/server/session/session.py", line 244, in initialize_agent
    await self.agent_session.start(
  File "/workspace/OpenHands/openhands/server/session/agent_session.py", line 135, in start
    runtime_connected = await self._create_runtime(
  File "/workspace/OpenHands/openhands/server/session/agent_session.py", line 352, in _create_runtime
    self.runtime = runtime_cls(
  File "/workspace/OpenHands/openhands/runtime/impl/docker/docker_runtime.py", line 131, in __init__
    self.docker_client: docker.DockerClient = self._init_docker_client()
  File "/workspace/OpenHands/openhands/runtime/impl/docker/docker_runtime.py", line 256, in _init_docker_client
    logger.error(
  File "/openhands/micromamba/envs/openhands/lib/python3.12/logging/__init__.py", line 1568, in error
    self._log(ERROR, msg, args, **kwargs)
  File "/openhands/micromamba/envs/openhands/lib/python3.12/logging/__init__.py", line 1684, in _log
    self.handle(record)

[92m01:09:25 - openhands:ERROR[0m: agent_session.py:220 - Agent session start failed in 0.025043487548828125s
Traceback (most recent call last):
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/openhands/micromamba/envs/openhands/lib/python3.12/http/client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/openhands/micromamba/envs/openhands/lib/python3.12/http/client.py", line 1093, in _send_output
    self.send(msg)
  File "/openhands/micromamba/envs/openhands/lib/python3.12/http/client.py", line 1037, in send
    self.connect()
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/docker/transport/unixconn.py", line 26, in connect
    sock.connect(self.unix_socket)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/requests/adapters.py", line 667, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/urllib3/util/retry.py", line 474, in increment
    raise reraise(type(error), error, _stacktrace)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/urllib3/util/util.py", line 38, in reraise
    raise value.with_traceback(tb)
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/openhands/micromamba/envs/openhands/lib/python3.12/http/client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/openhands/micromamba/envs/openhands/lib/python3.12/http/client.py", line 1093, in _send_output
    self.send(msg)
  File "/openhands/micromamba/envs/openhands/lib/python3.12/http/client.py", line 1037, in send
    self.connect()
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/docker/transport/unixconn.py", line 26, in connect
    sock.connect(self.unix_socket)
urllib3.exceptions.ProtocolError: ('Connection aborted.', ConnectionRefusedError(111, 'Connection refused'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/docker/api/client.py", line 223, in _retrieve_server_version
    return self.version(api_version=False)["ApiVersion"]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/docker/api/daemon.py", line 181, in version
    return self._result(self._get(url), json=True)
                        ^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/docker/utils/decorators.py", line 44, in inner
    return f(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/docker/api/client.py", line 246, in _get
    return self.get(url, **self._set_request_timeout(kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/requests/sessions.py", line 602, in get
    return self.request("GET", url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/requests/adapters.py", line 682, in send
    raise ConnectionError(err, request=request)
requests.exceptions.ConnectionError: ('Connection aborted.', ConnectionRefusedError(111, 'Connection refused'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspace/OpenHands/openhands/server/session/agent_session.py", line 135, in start
    runtime_connected = await self._create_runtime(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/OpenHands/openhands/server/session/agent_session.py", line 352, in _create_runtime
    self.runtime = runtime_cls(
                   ^^^^^^^^^^^^
  File "/workspace/OpenHands/openhands/runtime/impl/docker/docker_runtime.py", line 131, in __init__
    self.docker_client: docker.DockerClient = self._init_docker_client()
                                              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/OpenHands/openhands/runtime/impl/docker/docker_runtime.py", line 259, in _init_docker_client
    raise ex
  File "/workspace/OpenHands/openhands/runtime/impl/docker/docker_runtime.py", line 254, in _init_docker_client
    return docker.from_env()
           ^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/docker/client.py", line 94, in from_env
    return cls(
           ^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/docker/client.py", line 45, in __init__
    self.api = APIClient(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/docker/api/client.py", line 207, in __init__
    self._version = self._retrieve_server_version()
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/docker/api/client.py", line 230, in _retrieve_server_version
    raise DockerException(
docker.errors.DockerException: Error while fetching server API version: ('Connection aborted.', ConnectionRefusedError(111, 'Connection refused'))
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/workspace/OpenHands/openhands/server/__main__.py", line 20, in <module>
    main()
  File "/workspace/OpenHands/openhands/server/__main__.py", line 11, in main
    uvicorn.run(
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/uvicorn/main.py", line 580, in run
    server.run()
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/uvicorn/server.py", line 67, in run
    return asyncio.run(self.serve(sockets=sockets))
  File "/openhands/micromamba/envs/openhands/lib/python3.12/asyncio/runners.py", line 195, in run
    return runner.run(main)
  File "/openhands/micromamba/envs/openhands/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/openhands/micromamba/envs/openhands/lib/python3.12/asyncio/base_events.py", line 678, in run_until_complete
    self.run_forever()
  File "/openhands/micromamba/envs/openhands/lib/python3.12/asyncio/base_events.py", line 645, in run_forever
    self._run_once()
  File "/openhands/micromamba/envs/openhands/lib/python3.12/asyncio/base_events.py", line 1999, in _run_once
    handle._run()
  File "/openhands/micromamba/envs/openhands/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/workspace/OpenHands/openhands/server/session/session.py", line 244, in initialize_agent
    await self.agent_session.start(
  File "/workspace/OpenHands/openhands/server/session/agent_session.py", line 220, in start
    self.logger.error(
  File "/openhands/micromamba/envs/openhands/lib/python3.12/logging/__init__.py", line 1941, in error
    self.log(ERROR, msg, *args, **kwargs)
  File "/openhands/micromamba/envs/openhands/lib/python3.12/logging/__init__.py", line 1962, in log
    self.logger.log(level, msg, *args, **kwargs)
  File "/openhands/micromamba/envs/openhands/lib/python3.12/logging/__init__.py", line 1609, in log
    self._log(level, msg, args, **kwargs)
  File "/openhands/micromamba/envs/openhands/lib/python3.12/logging/__init__.py", line 1684, in _log
    self.handle(record)

[92m01:09:26 - openhands:ERROR[0m: session.py:278 - Error creating agent_session: Error while fetching server API version: ('Connection aborted.', ConnectionRefusedError(111, 'Connection refused'))
Traceback (most recent call last):
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/openhands/micromamba/envs/openhands/lib/python3.12/http/client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/openhands/micromamba/envs/openhands/lib/python3.12/http/client.py", line 1093, in _send_output
    self.send(msg)
  File "/openhands/micromamba/envs/openhands/lib/python3.12/http/client.py", line 1037, in send
    self.connect()
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/docker/transport/unixconn.py", line 26, in connect
    sock.connect(self.unix_socket)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/requests/adapters.py", line 667, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/urllib3/util/retry.py", line 474, in increment
    raise reraise(type(error), error, _stacktrace)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/urllib3/util/util.py", line 38, in reraise
    raise value.with_traceback(tb)
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/openhands/micromamba/envs/openhands/lib/python3.12/http/client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/openhands/micromamba/envs/openhands/lib/python3.12/http/client.py", line 1093, in _send_output
    self.send(msg)
  File "/openhands/micromamba/envs/openhands/lib/python3.12/http/client.py", line 1037, in send
    self.connect()
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/docker/transport/unixconn.py", line 26, in connect
    sock.connect(self.unix_socket)
urllib3.exceptions.ProtocolError: ('Connection aborted.', ConnectionRefusedError(111, 'Connection refused'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/docker/api/client.py", line 223, in _retrieve_server_version
    return self.version(api_version=False)["ApiVersion"]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/docker/api/daemon.py", line 181, in version
    return self._result(self._get(url), json=True)
                        ^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/docker/utils/decorators.py", line 44, in inner
    return f(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/docker/api/client.py", line 246, in _get
    return self.get(url, **self._set_request_timeout(kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/requests/sessions.py", line 602, in get
    return self.request("GET", url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/requests/adapters.py", line 682, in send
    raise ConnectionError(err, request=request)
requests.exceptions.ConnectionError: ('Connection aborted.', ConnectionRefusedError(111, 'Connection refused'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspace/OpenHands/openhands/server/session/session.py", line 244, in initialize_agent
    await self.agent_session.start(
  File "/workspace/OpenHands/openhands/server/session/agent_session.py", line 135, in start
    runtime_connected = await self._create_runtime(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/OpenHands/openhands/server/session/agent_session.py", line 352, in _create_runtime
    self.runtime = runtime_cls(
                   ^^^^^^^^^^^^
  File "/workspace/OpenHands/openhands/runtime/impl/docker/docker_runtime.py", line 131, in __init__
    self.docker_client: docker.DockerClient = self._init_docker_client()
                                              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/OpenHands/openhands/runtime/impl/docker/docker_runtime.py", line 259, in _init_docker_client
    raise ex
  File "/workspace/OpenHands/openhands/runtime/impl/docker/docker_runtime.py", line 254, in _init_docker_client
    return docker.from_env()
           ^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/docker/client.py", line 94, in from_env
    return cls(
           ^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/docker/client.py", line 45, in __init__
    self.api = APIClient(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/docker/api/client.py", line 207, in __init__
    self._version = self._retrieve_server_version()
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/docker/api/client.py", line 230, in _retrieve_server_version
    raise DockerException(
docker.errors.DockerException: Error while fetching server API version: ('Connection aborted.', ConnectionRefusedError(111, 'Connection refused'))
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/workspace/OpenHands/openhands/server/__main__.py", line 20, in <module>
    main()
  File "/workspace/OpenHands/openhands/server/__main__.py", line 11, in main
    uvicorn.run(
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/uvicorn/main.py", line 580, in run
    server.run()
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/uvicorn/server.py", line 67, in run
    return asyncio.run(self.serve(sockets=sockets))
  File "/openhands/micromamba/envs/openhands/lib/python3.12/asyncio/runners.py", line 195, in run
    return runner.run(main)
  File "/openhands/micromamba/envs/openhands/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/openhands/micromamba/envs/openhands/lib/python3.12/asyncio/base_events.py", line 678, in run_until_complete
    self.run_forever()
  File "/openhands/micromamba/envs/openhands/lib/python3.12/asyncio/base_events.py", line 645, in run_forever
    self._run_once()
  File "/openhands/micromamba/envs/openhands/lib/python3.12/asyncio/base_events.py", line 1999, in _run_once
    handle._run()
  File "/openhands/micromamba/envs/openhands/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/workspace/OpenHands/openhands/server/session/session.py", line 278, in initialize_agent
    self.logger.exception(f'Error creating agent_session: {e}')
  File "/openhands/micromamba/envs/openhands/lib/python3.12/logging/__init__.py", line 1947, in exception
    self.log(ERROR, msg, *args, exc_info=exc_info, **kwargs)
  File "/openhands/micromamba/envs/openhands/lib/python3.12/logging/__init__.py", line 1962, in log
    self.logger.log(level, msg, *args, **kwargs)
  File "/openhands/micromamba/envs/openhands/lib/python3.12/logging/__init__.py", line 1609, in log
    self._log(level, msg, args, **kwargs)
  File "/openhands/micromamba/envs/openhands/lib/python3.12/logging/__init__.py", line 1684, in _log
    self.handle(record)

[92m01:09:26 - openhands:WARNING[0m: session.py:380 - There is no listening client in the current room, waiting for the 1th attempt: ba9c4219c23a48849037ce9a1ec69cc5
[92m01:09:26 - openhands:INFO[0m: manage_conversations.py:727 - Updated old conversation title: 181b1f09ae3048afa7438dd9ae79c173
INFO:     127.0.0.1:57062 - "POST /api/conversations/181b1f09ae3048afa7438dd9ae79c173/reset HTTP/1.1" 200 OK
[92m01:09:26 - openhands:WARNING[0m: session.py:380 - There is no listening client in the current room, waiting for the 2th attempt: ba9c4219c23a48849037ce9a1ec69cc5
[92m01:09:26 - openhands:WARNING[0m: session.py:380 - There is no listening client in the current room, waiting for the 3th attempt: ba9c4219c23a48849037ce9a1ec69cc5
[92m01:09:26 - openhands:WARNING[0m: session.py:380 - There is no listening client in the current room, waiting for the 4th attempt: ba9c4219c23a48849037ce9a1ec69cc5
[92m01:09:26 - openhands:WARNING[0m: session.py:380 - There is no listening client in the current room, waiting for the 5th attempt: ba9c4219c23a48849037ce9a1ec69cc5
[92m01:09:26 - openhands:WARNING[0m: session.py:380 - There is no listening client in the current room, waiting for the 6th attempt: ba9c4219c23a48849037ce9a1ec69cc5
[92m01:09:26 - openhands:WARNING[0m: session.py:380 - There is no listening client in the current room, waiting for the 7th attempt: ba9c4219c23a48849037ce9a1ec69cc5
[92m01:09:26 - openhands:WARNING[0m: session.py:380 - There is no listening client in the current room, waiting for the 8th attempt: ba9c4219c23a48849037ce9a1ec69cc5
[92m01:09:26 - openhands:WARNING[0m: session.py:380 - There is no listening client in the current room, waiting for the 9th attempt: ba9c4219c23a48849037ce9a1ec69cc5
[92m01:09:26 - openhands:WARNING[0m: session.py:380 - There is no listening client in the current room, waiting for the 10th attempt: ba9c4219c23a48849037ce9a1ec69cc5
[92m01:09:27 - openhands:WARNING[0m: session.py:380 - There is no listening client in the current room, waiting for the 11th attempt: ba9c4219c23a48849037ce9a1ec69cc5
[92m01:09:27 - openhands:WARNING[0m: session.py:380 - There is no listening client in the current room, waiting for the 12th attempt: ba9c4219c23a48849037ce9a1ec69cc5
[92m01:09:27 - openhands:WARNING[0m: session.py:380 - There is no listening client in the current room, waiting for the 13th attempt: ba9c4219c23a48849037ce9a1ec69cc5
[92m01:09:27 - openhands:WARNING[0m: session.py:380 - There is no listening client in the current room, waiting for the 14th attempt: ba9c4219c23a48849037ce9a1ec69cc5
[92m01:09:27 - openhands:WARNING[0m: session.py:380 - There is no listening client in the current room, waiting for the 15th attempt: ba9c4219c23a48849037ce9a1ec69cc5
[92m01:09:27 - openhands:WARNING[0m: session.py:380 - There is no listening client in the current room, waiting for the 16th attempt: ba9c4219c23a48849037ce9a1ec69cc5
[92m01:09:27 - openhands:WARNING[0m: session.py:380 - There is no listening client in the current room, waiting for the 17th attempt: ba9c4219c23a48849037ce9a1ec69cc5
[92m01:09:27 - openhands:WARNING[0m: session.py:380 - There is no listening client in the current room, waiting for the 18th attempt: ba9c4219c23a48849037ce9a1ec69cc5
[92m01:09:27 - openhands:WARNING[0m: session.py:380 - There is no listening client in the current room, waiting for the 19th attempt: ba9c4219c23a48849037ce9a1ec69cc5
[92m01:09:27 - openhands:WARNING[0m: session.py:380 - There is no listening client in the current room, waiting for the 20th attempt: ba9c4219c23a48849037ce9a1ec69cc5
INFO:     127.0.0.1:50708 - "GET /locales/en/translation.json HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:52470 - "POST /api/unset-provider-tokens HTTP/1.1" 200 OK
INFO:     127.0.0.1:52478 - "GET /api/user/installations?provider=github HTTP/1.1" 401 Unauthorized
INFO:     127.0.0.1:52454 - "GET /api/billing/subscription-access HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:52466 - "GET /api/billing/subscription-access HTTP/1.1" 404 Not Found
DEBUG:    = connection is CONNECTING
DEBUG:    < GET /socket.io/?conversation_id=72.20170021676515&session_api_key=null&providers_set=github&EIO=4&transport=websocket HTTP/1.1
DEBUG:    < sec-websocket-version: 13
DEBUG:    < sec-websocket-key: ENH/c8UEd81kgAElm65w/w==
DEBUG:    < connection: Upgrade
DEBUG:    < upgrade: websocket
DEBUG:    < sec-websocket-extensions: permessage-deflate; client_max_window_bits
DEBUG:    < host: localhost:3000
INFO:     127.0.0.1:34484 - "WebSocket /socket.io/?conversation_id=72.20170021676515&session_api_key=null&providers_set=github&EIO=4&transport=websocket" [accepted]
DEBUG:    > HTTP/1.1 101 Switching Protocols
DEBUG:    > Upgrade: websocket
DEBUG:    > Connection: Upgrade
DEBUG:    > Sec-WebSocket-Accept: kzhMpHXnRPOemQXCyhJsrEElsp0=
DEBUG:    > Sec-WebSocket-Extensions: permessage-deflate
DEBUG:    > date: Thu, 04 Sep 2025 01:11:22 GMT
DEBUG:    > server: uvicorn
INFO:     connection open
DEBUG:    = connection is OPEN
DEBUG:    > TEXT '0{"sid":"LfUs7MIpfb79Ppl4AAAA","upgrades":[],"p...0,"maxPayload":4194304}' [107 bytes]
DEBUG:    < TEXT '40' [2 bytes]
[92m01:11:23 - openhands:INFO[0m: listen_socket.py:38 - sio:connect: uZ-p88uYj2ysrDD0AAAB
[92m01:11:23 - openhands:INFO[0m: listen_socket.py:49 - Socket request for conversation 72.20170021676515 with connection_id uZ-p88uYj2ysrDD0AAAB
[92m01:11:23 - openhands:INFO[0m: conversation_validator.py:56 - Creating new conversation metadata for 72.20170021676515
[92m01:11:23 - openhands:INFO[0m: listen_socket.py:74 - User None is allowed to connect to conversation 72.20170021676515
[92m01:11:23 - openhands:INFO[0m: listen_socket.py:88 - Replaying event stream for conversation 72.20170021676515 with connection_id uZ-p88uYj2ysrDD0AAAB...
[92m01:11:23 - openhands:DEBUG[0m: event_store.py:72 - No events found for session 72.20170021676515 at sessions/72.20170021676515/events/
[92m01:11:23 - openhands:INFO[0m: listen_socket.py:116 - Finished replaying event stream for conversation 72.20170021676515
[92m01:11:23 - openhands:INFO[0m: conversation_service.py:242 - Git provider scaffold: {<ProviderType.GITHUB: 'github'>: ProviderToken(token=None, user_id=None, host=None)}
[92m01:11:23 - openhands:INFO[0m: standalone_conversation_manager.py:158 - join_conversation:72.20170021676515:uZ-p88uYj2ysrDD0AAAB
[92m01:11:23 - openhands:INFO[0m: standalone_conversation_manager.py:288 - maybe_start_agent_loop:72.20170021676515
[92m01:11:23 - openhands:INFO[0m: standalone_conversation_manager.py:304 - starting_agent_loop:72.20170021676515
[92m01:11:23 - openhands:INFO[0m: llm_registry.py:87 - [LLM registry 26e13bbf-b706-4111-8701-52ef7881ead0]: Registering service for agent
[92m01:11:23 - openhands:INFO[0m: llm.py:444 - No data field in model info response from LiteLLM proxy: {'detail': 'Not Found'}
[92m01:11:23 - openhands:DEBUG[0m: llm.py:483 - Model info: {
  "model": "litellm_proxy/openrouter/moonshotai/kimi-k2:free",
  "base_url": "http://172.17.0.1:4001/v1"
}
[92m01:11:24 - openhands:INFO[0m: listen_socket.py:134 - Successfully joined conversation 72.20170021676515 with connection_id uZ-p88uYj2ysrDD0AAAB
[92m01:11:24 - openhands:DEBUG[0m: event_store.py:72 - No events found for session 72.20170021676515 at sessions/72.20170021676515/events/
[92m01:11:24 - openhands:DEBUG[0m: session.py:164 - MCP configuration before setup - self.config.mcp_config: sse_servers=[] stdio_servers=[] shttp_servers=[]
[92m01:11:24 - openhands:DEBUG[0m: session.py:173 - Merged custom MCP Config: sse_servers=[] stdio_servers=[] shttp_servers=[]
[92m01:11:24 - openhands:WARNING[0m: mcp_config.py:331 - No search engine API key found, skipping search engine
[92m01:11:24 - openhands:DEBUG[0m: session.py:184 - Added default MCP HTTP server to config
[92m01:11:24 - openhands:DEBUG[0m: session.py:188 - MCP configuration after setup - self.config.mcp: sse_servers=[] stdio_servers=[] shttp_servers=[MCPSHTTPServerConfig(url='http://localhost:3000/mcp/mcp', api_key='******')]
[92m01:11:24 - openhands:INFO[0m: session.py:219 - Enabling pipeline condenser with: browser_output_masking(attention_window=2),  llm(model="litellm_proxy/openrouter/moonshotai/kimi-k2:free",  base_url="http://172.17.0.1:4001/v1",  keep_first=4, max_size=120)
[92m01:11:24 - openhands:INFO[0m: llm_registry.py:87 - [LLM registry 26e13bbf-b706-4111-8701-52ef7881ead0]: Registering service for condenser
[92m01:11:24 - openhands:INFO[0m: llm.py:444 - No data field in model info response from LiteLLM proxy: {'detail': 'Not Found'}
[92m01:11:24 - openhands:DEBUG[0m: llm.py:483 - Model info: {
  "model": "litellm_proxy/openrouter/moonshotai/kimi-k2:free",
  "base_url": "http://172.17.0.1:4001/v1"
}
[92m01:11:24 - openhands:DEBUG[0m: codeact_agent.py:93 - Using condenser: <class 'openhands.memory.condenser.impl.pipeline.CondenserPipeline'>
[92m01:11:24 - openhands:DEBUG[0m: agent_session.py:322 - Initializing runtime `docker` now...
[92m01:11:24 - openhands:ERROR[0m: docker_runtime.py:256 - Launch docker client failed. Please make sure you have installed docker and started docker desktop/daemon.
Traceback (most recent call last):
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/openhands/micromamba/envs/openhands/lib/python3.12/http/client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/openhands/micromamba/envs/openhands/lib/python3.12/http/client.py", line 1093, in _send_output
    self.send(msg)
  File "/openhands/micromamba/envs/openhands/lib/python3.12/http/client.py", line 1037, in send
    self.connect()
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/docker/transport/unixconn.py", line 26, in connect
    sock.connect(self.unix_socket)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/requests/adapters.py", line 667, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/urllib3/util/retry.py", line 474, in increment
    raise reraise(type(error), error, _stacktrace)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/urllib3/util/util.py", line 38, in reraise
    raise value.with_traceback(tb)
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/openhands/micromamba/envs/openhands/lib/python3.12/http/client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/openhands/micromamba/envs/openhands/lib/python3.12/http/client.py", line 1093, in _send_output
    self.send(msg)
  File "/openhands/micromamba/envs/openhands/lib/python3.12/http/client.py", line 1037, in send
    self.connect()
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/docker/transport/unixconn.py", line 26, in connect
    sock.connect(self.unix_socket)
urllib3.exceptions.ProtocolError: ('Connection aborted.', ConnectionRefusedError(111, 'Connection refused'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/docker/api/client.py", line 223, in _retrieve_server_version
    return self.version(api_version=False)["ApiVersion"]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/docker/api/daemon.py", line 181, in version
    return self._result(self._get(url), json=True)
                        ^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/docker/utils/decorators.py", line 44, in inner
    return f(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/docker/api/client.py", line 246, in _get
    return self.get(url, **self._set_request_timeout(kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/requests/sessions.py", line 602, in get
    return self.request("GET", url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/requests/adapters.py", line 682, in send
    raise ConnectionError(err, request=request)
requests.exceptions.ConnectionError: ('Connection aborted.', ConnectionRefusedError(111, 'Connection refused'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspace/OpenHands/openhands/runtime/impl/docker/docker_runtime.py", line 254, in _init_docker_client
    return docker.from_env()
           ^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/docker/client.py", line 94, in from_env
    return cls(
           ^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/docker/client.py", line 45, in __init__
    self.api = APIClient(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/docker/api/client.py", line 207, in __init__
    self._version = self._retrieve_server_version()
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/docker/api/client.py", line 230, in _retrieve_server_version
    raise DockerException(
docker.errors.DockerException: Error while fetching server API version: ('Connection aborted.', ConnectionRefusedError(111, 'Connection refused'))
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/workspace/OpenHands/openhands/server/__main__.py", line 20, in <module>
    main()
  File "/workspace/OpenHands/openhands/server/__main__.py", line 11, in main
    uvicorn.run(
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/uvicorn/main.py", line 580, in run
    server.run()
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/uvicorn/server.py", line 67, in run
    return asyncio.run(self.serve(sockets=sockets))
  File "/openhands/micromamba/envs/openhands/lib/python3.12/asyncio/runners.py", line 195, in run
    return runner.run(main)
  File "/openhands/micromamba/envs/openhands/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/openhands/micromamba/envs/openhands/lib/python3.12/asyncio/base_events.py", line 678, in run_until_complete
    self.run_forever()
  File "/openhands/micromamba/envs/openhands/lib/python3.12/asyncio/base_events.py", line 645, in run_forever
    self._run_once()
  File "/openhands/micromamba/envs/openhands/lib/python3.12/asyncio/base_events.py", line 1999, in _run_once
    handle._run()
  File "/openhands/micromamba/envs/openhands/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/workspace/OpenHands/openhands/server/session/session.py", line 244, in initialize_agent
    await self.agent_session.start(
  File "/workspace/OpenHands/openhands/server/session/agent_session.py", line 135, in start
    runtime_connected = await self._create_runtime(
  File "/workspace/OpenHands/openhands/server/session/agent_session.py", line 352, in _create_runtime
    self.runtime = runtime_cls(
  File "/workspace/OpenHands/openhands/runtime/impl/docker/docker_runtime.py", line 131, in __init__
    self.docker_client: docker.DockerClient = self._init_docker_client()
  File "/workspace/OpenHands/openhands/runtime/impl/docker/docker_runtime.py", line 256, in _init_docker_client
    logger.error(
  File "/openhands/micromamba/envs/openhands/lib/python3.12/logging/__init__.py", line 1568, in error
    self._log(ERROR, msg, args, **kwargs)
  File "/openhands/micromamba/envs/openhands/lib/python3.12/logging/__init__.py", line 1684, in _log
    self.handle(record)

[92m01:11:24 - openhands:ERROR[0m: agent_session.py:220 - Agent session start failed in 0.027635812759399414s
Traceback (most recent call last):
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/openhands/micromamba/envs/openhands/lib/python3.12/http/client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/openhands/micromamba/envs/openhands/lib/python3.12/http/client.py", line 1093, in _send_output
    self.send(msg)
  File "/openhands/micromamba/envs/openhands/lib/python3.12/http/client.py", line 1037, in send
    self.connect()
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/docker/transport/unixconn.py", line 26, in connect
    sock.connect(self.unix_socket)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/requests/adapters.py", line 667, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/urllib3/util/retry.py", line 474, in increment
    raise reraise(type(error), error, _stacktrace)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/urllib3/util/util.py", line 38, in reraise
    raise value.with_traceback(tb)
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/openhands/micromamba/envs/openhands/lib/python3.12/http/client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/openhands/micromamba/envs/openhands/lib/python3.12/http/client.py", line 1093, in _send_output
    self.send(msg)
  File "/openhands/micromamba/envs/openhands/lib/python3.12/http/client.py", line 1037, in send
    self.connect()
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/docker/transport/unixconn.py", line 26, in connect
    sock.connect(self.unix_socket)
urllib3.exceptions.ProtocolError: ('Connection aborted.', ConnectionRefusedError(111, 'Connection refused'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/docker/api/client.py", line 223, in _retrieve_server_version
    return self.version(api_version=False)["ApiVersion"]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/docker/api/daemon.py", line 181, in version
    return self._result(self._get(url), json=True)
                        ^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/docker/utils/decorators.py", line 44, in inner
    return f(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/docker/api/client.py", line 246, in _get
    return self.get(url, **self._set_request_timeout(kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/requests/sessions.py", line 602, in get
    return self.request("GET", url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/requests/adapters.py", line 682, in send
    raise ConnectionError(err, request=request)
requests.exceptions.ConnectionError: ('Connection aborted.', ConnectionRefusedError(111, 'Connection refused'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspace/OpenHands/openhands/server/session/agent_session.py", line 135, in start
    runtime_connected = await self._create_runtime(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/OpenHands/openhands/server/session/agent_session.py", line 352, in _create_runtime
    self.runtime = runtime_cls(
                   ^^^^^^^^^^^^
  File "/workspace/OpenHands/openhands/runtime/impl/docker/docker_runtime.py", line 131, in __init__
    self.docker_client: docker.DockerClient = self._init_docker_client()
                                              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/OpenHands/openhands/runtime/impl/docker/docker_runtime.py", line 259, in _init_docker_client
    raise ex
  File "/workspace/OpenHands/openhands/runtime/impl/docker/docker_runtime.py", line 254, in _init_docker_client
    return docker.from_env()
           ^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/docker/client.py", line 94, in from_env
    return cls(
           ^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/docker/client.py", line 45, in __init__
    self.api = APIClient(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/docker/api/client.py", line 207, in __init__
    self._version = self._retrieve_server_version()
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/docker/api/client.py", line 230, in _retrieve_server_version
    raise DockerException(
docker.errors.DockerException: Error while fetching server API version: ('Connection aborted.', ConnectionRefusedError(111, 'Connection refused'))
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/workspace/OpenHands/openhands/server/__main__.py", line 20, in <module>
    main()
  File "/workspace/OpenHands/openhands/server/__main__.py", line 11, in main
    uvicorn.run(
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/uvicorn/main.py", line 580, in run
    server.run()
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/uvicorn/server.py", line 67, in run
    return asyncio.run(self.serve(sockets=sockets))
  File "/openhands/micromamba/envs/openhands/lib/python3.12/asyncio/runners.py", line 195, in run
    return runner.run(main)
  File "/openhands/micromamba/envs/openhands/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/openhands/micromamba/envs/openhands/lib/python3.12/asyncio/base_events.py", line 678, in run_until_complete
    self.run_forever()
  File "/openhands/micromamba/envs/openhands/lib/python3.12/asyncio/base_events.py", line 645, in run_forever
    self._run_once()
  File "/openhands/micromamba/envs/openhands/lib/python3.12/asyncio/base_events.py", line 1999, in _run_once
    handle._run()
  File "/openhands/micromamba/envs/openhands/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/workspace/OpenHands/openhands/server/session/session.py", line 244, in initialize_agent
    await self.agent_session.start(
  File "/workspace/OpenHands/openhands/server/session/agent_session.py", line 220, in start
    self.logger.error(
  File "/openhands/micromamba/envs/openhands/lib/python3.12/logging/__init__.py", line 1941, in error
    self.log(ERROR, msg, *args, **kwargs)
  File "/openhands/micromamba/envs/openhands/lib/python3.12/logging/__init__.py", line 1962, in log
    self.logger.log(level, msg, *args, **kwargs)
  File "/openhands/micromamba/envs/openhands/lib/python3.12/logging/__init__.py", line 1609, in log
    self._log(level, msg, args, **kwargs)
  File "/openhands/micromamba/envs/openhands/lib/python3.12/logging/__init__.py", line 1684, in _log
    self.handle(record)

[92m01:11:24 - openhands:ERROR[0m: session.py:278 - Error creating agent_session: Error while fetching server API version: ('Connection aborted.', ConnectionRefusedError(111, 'Connection refused'))
Traceback (most recent call last):
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/openhands/micromamba/envs/openhands/lib/python3.12/http/client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/openhands/micromamba/envs/openhands/lib/python3.12/http/client.py", line 1093, in _send_output
    self.send(msg)
  File "/openhands/micromamba/envs/openhands/lib/python3.12/http/client.py", line 1037, in send
    self.connect()
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/docker/transport/unixconn.py", line 26, in connect
    sock.connect(self.unix_socket)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/requests/adapters.py", line 667, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/urllib3/util/retry.py", line 474, in increment
    raise reraise(type(error), error, _stacktrace)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/urllib3/util/util.py", line 38, in reraise
    raise value.with_traceback(tb)
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/openhands/micromamba/envs/openhands/lib/python3.12/http/client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/openhands/micromamba/envs/openhands/lib/python3.12/http/client.py", line 1093, in _send_output
    self.send(msg)
  File "/openhands/micromamba/envs/openhands/lib/python3.12/http/client.py", line 1037, in send
    self.connect()
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/docker/transport/unixconn.py", line 26, in connect
    sock.connect(self.unix_socket)
urllib3.exceptions.ProtocolError: ('Connection aborted.', ConnectionRefusedError(111, 'Connection refused'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/docker/api/client.py", line 223, in _retrieve_server_version
    return self.version(api_version=False)["ApiVersion"]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/docker/api/daemon.py", line 181, in version
    return self._result(self._get(url), json=True)
                        ^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/docker/utils/decorators.py", line 44, in inner
    return f(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/docker/api/client.py", line 246, in _get
    return self.get(url, **self._set_request_timeout(kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/requests/sessions.py", line 602, in get
    return self.request("GET", url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/requests/adapters.py", line 682, in send
    raise ConnectionError(err, request=request)
requests.exceptions.ConnectionError: ('Connection aborted.', ConnectionRefusedError(111, 'Connection refused'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspace/OpenHands/openhands/server/session/session.py", line 244, in initialize_agent
    await self.agent_session.start(
  File "/workspace/OpenHands/openhands/server/session/agent_session.py", line 135, in start
    runtime_connected = await self._create_runtime(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/OpenHands/openhands/server/session/agent_session.py", line 352, in _create_runtime
    self.runtime = runtime_cls(
                   ^^^^^^^^^^^^
  File "/workspace/OpenHands/openhands/runtime/impl/docker/docker_runtime.py", line 131, in __init__
    self.docker_client: docker.DockerClient = self._init_docker_client()
                                              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/OpenHands/openhands/runtime/impl/docker/docker_runtime.py", line 259, in _init_docker_client
    raise ex
  File "/workspace/OpenHands/openhands/runtime/impl/docker/docker_runtime.py", line 254, in _init_docker_client
    return docker.from_env()
           ^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/docker/client.py", line 94, in from_env
    return cls(
           ^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/docker/client.py", line 45, in __init__
    self.api = APIClient(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/docker/api/client.py", line 207, in __init__
    self._version = self._retrieve_server_version()
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/docker/api/client.py", line 230, in _retrieve_server_version
    raise DockerException(
docker.errors.DockerException: Error while fetching server API version: ('Connection aborted.', ConnectionRefusedError(111, 'Connection refused'))
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/workspace/OpenHands/openhands/server/__main__.py", line 20, in <module>
    main()
  File "/workspace/OpenHands/openhands/server/__main__.py", line 11, in main
    uvicorn.run(
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/uvicorn/main.py", line 580, in run
    server.run()
  File "/openhands/poetry/openhands-ai-5O4_aCHf-py3.12/lib/python3.12/site-packages/uvicorn/server.py", line 67, in run
    return asyncio.run(self.serve(sockets=sockets))
  File "/openhands/micromamba/envs/openhands/lib/python3.12/asyncio/runners.py", line 195, in run
    return runner.run(main)
  File "/openhands/micromamba/envs/openhands/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/openhands/micromamba/envs/openhands/lib/python3.12/asyncio/base_events.py", line 678, in run_until_complete
    self.run_forever()
  File "/openhands/micromamba/envs/openhands/lib/python3.12/asyncio/base_events.py", line 645, in run_forever
    self._run_once()
  File "/openhands/micromamba/envs/openhands/lib/python3.12/asyncio/base_events.py", line 1999, in _run_once
    handle._run()
  File "/openhands/micromamba/envs/openhands/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/workspace/OpenHands/openhands/server/session/session.py", line 278, in initialize_agent
    self.logger.exception(f'Error creating agent_session: {e}')
  File "/openhands/micromamba/envs/openhands/lib/python3.12/logging/__init__.py", line 1947, in exception
    self.log(ERROR, msg, *args, exc_info=exc_info, **kwargs)
  File "/openhands/micromamba/envs/openhands/lib/python3.12/logging/__init__.py", line 1962, in log
    self.logger.log(level, msg, *args, **kwargs)
  File "/openhands/micromamba/envs/openhands/lib/python3.12/logging/__init__.py", line 1609, in log
    self._log(level, msg, args, **kwargs)
  File "/openhands/micromamba/envs/openhands/lib/python3.12/logging/__init__.py", line 1684, in _log
    self.handle(record)

DEBUG:    > TEXT '40{"sid":"uZ-p88uYj2ysrDD0AAAB"}' [32 bytes]
DEBUG:    > TEXT '42["oh_event",{"id":0,"timestamp":"2025-09-04T0...loading","reason":""}}]' [190 bytes]
DEBUG:    > TEXT '42["oh_event",{"error":true,"message":"Failed t...ion: DockerException"}]' [89 bytes]
DEBUG:    ! failing connection with code 1006
DEBUG:    = connection is CLOSED
DEBUG:    x half-closing TCP connection
INFO:     connection closed
[92m01:11:26 - openhands:INFO[0m: listen_socket.py:157 - sio:disconnect:uZ-p88uYj2ysrDD0AAAB
[92m01:11:26 - openhands:INFO[0m: standalone_conversation_manager.py:399 - disconnect_from_session:uZ-p88uYj2ysrDD0AAAB:72.20170021676515
INFO:     127.0.0.1:36986 - "GET /api/billing/subscription-access HTTP/1.1" 404 Not Found
[92m02:09:36 - openhands:INFO[0m: standalone_conversation_manager.py:430 - _close_session:ba9c4219c23a48849037ce9a1ec69cc5
[92m02:09:36 - openhands:INFO[0m: standalone_conversation_manager.py:438 - removing connections: []
[92m02:09:36 - openhands:INFO[0m: standalone_conversation_manager.py:452 - closing_session:ba9c4219c23a48849037ce9a1ec69cc5
[92m02:09:36 - openhands:INFO[0m: standalone_conversation_manager.py:454 - closed_session:ba9c4219c23a48849037ce9a1ec69cc5
[92m02:11:36 - openhands:INFO[0m: standalone_conversation_manager.py:430 - _close_session:72.20170021676515
[92m02:11:36 - openhands:INFO[0m: standalone_conversation_manager.py:438 - removing connections: []
[92m02:11:36 - openhands:INFO[0m: standalone_conversation_manager.py:452 - closing_session:72.20170021676515
[92m02:11:36 - openhands:INFO[0m: standalone_conversation_manager.py:454 - closed_session:72.20170021676515
