

# ๐ฆ ูุธุงู **Runtime EventStream**

ูุธุงู **Runtime EventStream** ูู OpenHands ูู ุงููููู ุงูุฑุฆูุณู ุงูุฐู ูุชูุญ ุชูููุฐ ุงูุฃูุนุงู ุงูุฎุงุตุฉ ุจุงููููุงุก (agents) ุงูุฐูุงุก ุงูุงุตุทูุงุนู ุจุทุฑููุฉ ุขููุฉ ููุฑูุฉ. ูููู ุจุฅูุดุงุก ุจูุฆุฉ ูุนุฒููุฉ (sandbox) ุจุงุณุชุฎุฏุงู Dockerุ ุญูุซ ูููู ุชูููุฐ ุงูุดููุฑุฉ ุงูุจุฑูุฌูุฉ ุจุดูู ุขูู ุฏูู ุงูุชุฃุซูุฑ ุนูู ุงููุธุงู ุงูุฃุณุงุณู.

## ููุงุฐุง ูุญุชุงุฌ ุฅูู ุจูุฆุฉ ุชูููุฐ ูุนุฒููุฉุ

ูุฌุจ ุนูู OpenHands ุชูููุฐ ุงูุดููุฑุฉ ุงูุจุฑูุฌูุฉ ูู ุจูุฆุฉ ูุนุฒููุฉ ูุขููุฉ ูุนุฏุฉ ุฃุณุจุงุจ:

1. **ุงูุฃูุงู**: ุชูููุฐ ุงูุดููุฑุฉ ุบูุฑ ุงูููุซููุฉ ูููู ุฃู ูุดูู ุฎุทุฑุงู ูุจูุฑุงู ุนูู ุงููุธุงู ุงูุฃุณุงุณู. ุจูุฆุฉ ุงููุนุฒููุฉ ุชููุน ุงูุดููุฑุฉ ุงูุฎุจูุซุฉ ูู ุงููุตูู ุฅูู ููุงุฑุฏ ุงููุธุงู ุงูุฃุณุงุณู ุฃู ุชุนุฏูููุง.
2. **ุงูุชูุงุณู**: ุชุถูู ุงูุจูุฆุฉ ุงููุนุฒููุฉ ุชูููุฐ ุงูุดููุฑุฉ ุจุดูู ูุชูุงุณู ุนูู ุฃูุธูุฉ ูุฃุฌูุฒุฉ ูุฎุชููุฉุ ููุง ูุญู ูุดููุฉ "ุงูุดููุฑุฉ ุชุนูู ุนูู ุฌูุงุฒู".
3. **ุงูุชุญูู ูู ุงูููุงุฑุฏ**: ุชููุฑ ุงูุจูุฆุฉ ุงููุนุฒููุฉ ุชุญููุงู ุฃูุถู ูู ุชุฎุตูุต ูุงุณุชุฎุฏุงู ุงูููุงุฑุฏุ ููุง ูููุน ุงูุนูููุงุช ุบูุฑ ุงููุณูุทุฑ ุนูููุง ูู ุงูุชุฃุซูุฑ ุนูู ุงููุธุงู ุงูุฃุณุงุณู.
4. **ุงูุนุฒู**: ูููู ูููุดุงุฑูุน ุฃู ุงููุณุชุฎุฏููู ุงููุฎุชูููู ุงูุนูู ูู ุจูุฆุงุช ูุนุฒููุฉ ุฏูู ุงูุชุฃุซูุฑ ุนูู ุจุนุถูู ุงูุจุนุถ ุฃู ุนูู ุงููุธุงู ุงูุฃุณุงุณู.
5. **ุงูุงุณุชูุณุงุฎ**: ุชุณูู ุงูุจูุฆุงุช ุงููุนุฒููุฉ ุฅุนุงุฏุฉ ุฅูุดุงุก ุงูุฃุฎุทุงุก ูุงููุดุงููุ ุญูุซ ุชููู ุจูุฆุฉ ุงูุชูููุฐ ุซุงุจุชุฉ ููุงุจูุฉ ููุชุญูู.

## ููู ูุนูู ูุธุงู Runtimeุ

ูุธุงู Runtime ูู OpenHands ูุณุชุฎุฏู ูููููุฉ ุนููู-ุฎุงุฏู ูุนุชูุฏุฉ ุนูู ุญุงููุงุช Docker. ุฅููู ูุธุฑุฉ ุนุงูุฉ ุนูู ููููุฉ ุนููู:

```mermaid
graph TD
    A[ุตูุฑุฉ Docker ูุฎุตุตุฉ ููุฏููุง ุงููุณุชุฎุฏู] --> B[ุงููุงุฌูุฉ ุงูุฎูููุฉ OpenHands]
    B -->|ุจูุงุก| C[ุตูุฑุฉ OH Runtime]
    C -->|ุชุดุบูู| D[ูููุฐ ุงูุฃูุนุงู]
    D -->|ุชููุฆุฉ| E[ุงููุชุตูุญ]
    D -->|ุชููุฆุฉ| F[Shell Bash]
    D -->|ุชููุฆุฉ| G[ุงูุฅุถุงูุงุช]
    G -->|ุชููุฆุฉ| L[ุฎุงุฏู Jupyter]

    B -->|ุฅูุดุงุก| H[ูููู]
    B -->|ุฅูุดุงุก| I[EventStream]
    I <--->|ุชูููุฐ ุงููุนู ููุญุตูู ุนูู ุงูููุงุญุธุฉ ุนุจุฑ API REST| D

    H -->|ููุดุฆ ุงููุนู| I
    I -->|ูุญุตู ุนูู ุงูููุงุญุธุฉ| H

    subgraph "ุญุงููุฉ Docker"
    D
    E
    F
    G
    L
    end
```

1. **ุฅุฏุฎุงู ุงููุณุชุฎุฏู**: ูููู ุงููุณุชุฎุฏู ุจุชูููุฑ ุตูุฑุฉ Docker ูุฎุตุตุฉ.
2. **ุจูุงุก ุงูุตูุฑุฉ**: ูููู OpenHands ุจุจูุงุก ุตูุฑุฉ Docker ุฌุฏูุฏุฉ ("ุตูุฑุฉ OH runtime") ุงุณุชูุงุฏุงู ุฅูู ุงูุตูุฑุฉ ุงูุชู ูุฏููุง ุงููุณุชุฎุฏู. ูุฐู ุงูุตูุฑุฉ ุงูุฌุฏูุฏุฉ ุชุชุถูู ุงูุดููุฑุฉ ุงูุจุฑูุฌูุฉ ุงูุฎุงุตุฉ ุจู OpenHands.
3. **ุชุดุบูู ุงูุญุงููุฉ**: ุนูุฏ ุจุฏุก OpenHandsุ ูุชู ุชุดุบูู ุญุงููุฉ Docker ุจุงุณุชุฎุฏุงู ุตูุฑุฉ OH runtime.
4. **ุชููุฆุฉ ุฎุงุฏู ุชูููุฐ ุงูุฃูุนุงู**: ูููู ุฎุงุฏู ุชูููุฐ ุงูุฃูุนุงู ุจุชููุฆุฉ `ActionExecutor` ุฏุงุฎู ุงูุญุงููุฉุ ูุถุจุท ุงูููููุงุช ุงููุงุฒูุฉ ูุซู shell bash ูุชุญููู ุงูุฅุถุงูุงุช.
5. **ุงูุชูุงุตู**: ูุชูุงุตู ูุงุฌูุฉ OpenHands ุงูุฎูููุฉ (`openhands/runtime/impl/eventstream/eventstream_runtime.py`) ูุน ุฎุงุฏู ุชูููุฐ ุงูุฃูุนุงู ุนุจุฑ API RESTfulุ ุญูุซ ูุชู ุฅุฑุณุงู ุงูุฃูุนุงู ูุงุณุชูุจุงู ุงูููุงุญุธุงุช.
6. **ุชูููุฐ ุงูุฃูุนุงู**: ูุณุชูุจู ุนููู runtime ุงูุฃูุนุงู ูู ุงููุงุฌูุฉ ุงูุฎูููุฉุ ููููู ุจุชูููุฐูุง ูู ุจูุฆุฉ ุงููุนุฒููุฉ ูุฅุฑุฌุงุน ุงูููุงุญุธุงุช.
7. **ุฅุฑุฌุงุน ุงูููุงุญุธุงุช**: ูุนูุฏ ุฎุงุฏู ุชูููุฐ ุงูุฃูุนุงู ูุชุงุฆุฌ ุงูุชูููุฐ ุฅูู ูุงุฌูุฉ OpenHands ุงูุฎูููุฉ ุนูู ุดูู ููุงุญุธุงุช.

### ุฏูุฑ ุงูุนููู:
- ูุนูู ููุณูุท ุจูู ุงููุงุฌูุฉ ุงูุฎูููุฉ ูู OpenHands ูุจูุฆุฉ ุงููุนุฒููุฉ.
- ูููุฐ ุฃููุงุน ูุฎุชููุฉ ูู ุงูุฃูุนุงู (ุฃูุงูุฑ shellุ ุนูููุงุช ุนูู ุงููููุงุชุ ุดููุฑุฉ Pythonุ ุฅูุฎ) ุจุฃูุงู ุฏุงุฎู ุงูุญุงููุฉ.
- ูุฏูุฑ ุญุงูุฉ ุงูุจูุฆุฉ ุงููุนุฒููุฉุ ุจูุง ูู ุฐูู ุงูุฏููู ุงูุญุงูู ูุงูุฅุถุงูุงุช ุงููุญููุฉ.
- ูููู ุจุชูุณูู ูุฅุฑุฌุงุน ุงูููุงุญุธุงุช ุฅูู ุงููุงุฌูุฉ ุงูุฎูููุฉุ ููุง ูุถูู ูุงุฌูุฉ ูุชูุงุณูุฉ ููุนุงูุฌุฉ ุงููุชุงุฆุฌ.

## ููู ูููู OpenHands ุจุจูุงุก ูุตูุงูุฉ ุตูุฑ OH Runtime

ูุชุจุน OpenHands ููุฌุงู ูุนุงูุงู ูุจูุงุก ูุฅุฏุงุฑุฉ ุตูุฑ runtime ููุง ูุถูู ุงูุชูุงุณู ูุงููุฑููุฉ ูู ุฅูุดุงุก ูุตูุงูุฉ ุตูุฑ Docker ููุจูุฆุงุช ุงูุฅูุชุงุฌูุฉ ูุงูุชุทููุฑูุฉ.

ุฑุงุฌุน [ุงูุดููุฑุฉ ุฐุงุช ุงูุตูุฉ](https://github.com/All-Hands-AI/OpenHands/blob/main/openhands/runtime/utils/runtime_build.py) ุฅุฐุง ููุช ุชุฑุบุจ ูู ูุฒูุฏ ูู ุงูุชูุงุตูู.

### ูุธุงู ุงูุนูุงูุงุช ููุตูุฑ

ูุณุชุฎุฏู OpenHands ูุธุงูุงู ูู ุซูุงุซ ุนูุงูุงุช ูุตูุฑ runtime ูุชุญููู ุชูุงุฒู ุจูู ุงููุงุจููุฉ ููุงุณุชูุณุงุฎ ูุงููุฑููุฉ. ูููู ุฃู ุชููู ุงูุนูุงูุงุช ุจุฃุญุฏ ุงูุตูุบุชูู ุงูุชุงููุชูู:

- **ุงูุนูุงูุฉ ุงููุฑููุฉ**: `oh_v{version_openhands}_{base_image}` (ูุซู: `oh_v0.9.9_nikolaik_s_python-nodejs_t_python3.12-nodejs22`)
- **ุงูุนูุงูุฉ ุงููุคููุฉ**: `oh_v{version_openhands}_{16_digit_lock_hash}` (ูุซู: `oh_v0.9.9_1234567890abcdef`)
- **ุงูุนูุงูุฉ ุงููุตุฏุฑูุฉ**: `oh_v{version_openhands}_{16_digit_lock_hash}_{16_digit_source_hash}`
  (ูุซู: `oh_v0.9.9_1234567890abcdef_1234567890abcdef`)

#### ุงูุนูุงูุฉ ุงููุตุฏุฑูุฉ - ุงูุฃูุซุฑ ุชุญุฏูุฏุงู

ูุฐู ูู ุฃูู 16 ุฑููุงู ูู MD5 ููุณู ุงููุฌูุฏ ุงููุตุฏุฑ. ูุฐู ุงูุนูุงูุฉ ูุฎุตุตุฉ ููุท ููุตุฏุฑ OpenHands.

#### ุงูุนูุงูุฉ ุงููุคููุฉ

ูุชู ุจูุงุก ูุฐู ุงูุนูุงูุฉ ุจุงุณุชุฎุฏุงู ุฃูู 16 ุฑููุงู ูู MD5:
- ุงุณู ุงูุตูุฑุฉ ุงูุฃุณุงุณูุฉ ุงูุชู ุชู ุจูุงุก ุงูุตูุฑุฉ ุนูููุง (ูุซู: `nikolaik/python-nodejs:python3.12-nodejs22`)
- ูุญุชููุงุช `pyproject.toml` ุงููุถููุฉ ูู ุงูุตูุฑุฉ.
- ูุญุชููุงุช `poetry.lock` ุงููุถููุฉ ูู ุงูุตูุฑุฉ.

ูุชู ุงุณุชุฎุฏุงู ูุฐู ุงูุนูุงูุฉ ูุชุญุฏูุฏ ุญุงูุฉ ุงูุงุนุชูุงุฏูุงุช ูู OpenHands ุจุบุถ ุงููุธุฑ ุนู ุงูุดููุฑุฉ ุงููุตุฏุฑูุฉ.

#### ุงูุนูุงูุฉ ุงููุฑููุฉ - ุงูุฃูุซุฑ ุนููููุฉ

ุชุนุฏ ูุฐู ุงูุนูุงูุฉ ูุฌุฑุฏ ุฏูุฌ ุจูู ุฅุตุฏุงุฑ OpenHands ูุงุณู ุงูุตูุฑุฉ ุงูุฃุณุงุณูุฉ (ูุชู ุชุนุฏููู ูููุงุณุจ ูุนูุงุฑ ุงูุนูุงูุงุช).

### ุนูููุฉ ุจูุงุก ุงูุตูุฑุฉ

ุนูุฏ ุจูุงุก ุตูุฑุฉ ุฌุฏูุฏุฉ...

- **ูุง ุญุงุฌุฉ ูุฅุนุงุฏุฉ ุงูุจูุงุก**: ูุชุญูู OpenHands ุฃููุงู ุฅุฐุง ูุงูุช ููุงู ุตูุฑุฉ ุจููุณ **ุงูุนูุงูุฉ ุงููุตุฏุฑูุฉ ุงูุฃูุซุฑ ุชุญุฏูุฏุงู**. ุฅุฐุง ูุงูุช ููุฌูุฏุฉุ ูุง ูุชู ุฅุนุงุฏุฉ ุงูุจูุงุก ูุชูุณุชุฎุฏู ุงูุตูุฑุฉ ุงูุญุงููุฉ.
- **ุฃุณุฑุน ุฅุนุงุฏุฉ ุจูุงุก**: ูุชุญูู OpenHands ุฅุฐุง ูุงูุช ููุงู ุตูุฑุฉ ุจููุณ **ุงูุนูุงูุฉ ุงููุคููุฉ**. ุฅุฐุง ูุงูุช ููุฌูุฏุฉุ ูุชู ุจูุงุก ุตูุฑุฉ ุฌุฏูุฏุฉ ุงุณุชูุงุฏุงู ุฅูููุงุ ูุน ุชุฌุงูุฒ ุฎุทูุงุช ุงูุชุซุจูุช ูุซู `poetry install` ู`apt-get`ุ ููุชู ููุท ูุณุฎ ุงูุดููุฑุฉ ุงููุตุฏุฑูุฉ ุงูุญุงููุฉ.
- **ุฅุนุงุฏุฉ ุจูุงุก ุตุญูุญุฉ**: ุฅุฐุง ูู ุชูุฌุฏ ุตูุฑุฉ ุจููุณ **ุงูุนูุงูุฉ ุงููุตุฏุฑูุฉ** ุฃู **ุงูุนูุงูุฉ ุงููุคููุฉ**ุ ูุชู ุจูุงุก ุตูุฑุฉ ุฌุฏูุฏุฉ ุงุณุชูุงุฏุงู ุฅูู ุตูุฑุฉ ุงูุนูุงูุฉ ุงููุฑููุฉ.
- **ุฃุจุทุฃ ุฅุนุงุฏุฉ ุจูุงุก**: ุฅุฐุง ูู ุชูู ููุงู ุฃู ูู ุงูุนูุงูุงุช ุงูุซูุงุซุ ูุชู ุจูุงุก ุตูุฑุฉ ุฌุฏูุฏุฉ ุจุงููุงูู ุงุณุชูุงุฏุงู ุฅูู ุงูุตูุฑุฉ ุงูุฃุณุงุณูุฉุ ููุง ูุณุชุบุฑู ููุชุงู ุฃุทูู.

### ูุธุงู ุงูุฅุถุงูุงุช ูู Runtime

ูุฏุนู OpenHands ูุธุงู ุงูุฅุถุงูุงุช ุงูุฐู ูุชูุญ ุชูุณูุน ุงููุธุงุฆู ูุชุฎุตูุต ุจูุฆุฉ ุงูุชูููุฐ. ูุชู ุชููุฆุฉ ุงูุฅุถุงูุงุช ุนูุฏ ุจุฏุก ุชุดุบูู ุงูุนููู runtime.

ุฑุงุฌุน [ูุซุงู ูุฅุถุงูุฉ Jupyter ููุง](https://github.com/All-Hands-AI/OpenHands/blob/ecf4aed28b0cf7c18d4d8ff554883ba182fc6bdd/openhands/runtime/plugins/jupyter/__init__.py#L21-L55) ุฅุฐุง ููุช ุชุฑุบุจ ูู ุชูููุฐ ุฅุถุงูุชู ุงูุฎุงุตุฉ.

*ุงููุฒูุฏ ูู ุงูุชูุงุตูู ุญูู ูุธุงู ุงูุฅุถุงูุงุช ููุฏ ุงูุฅูุดุงุก - ุงููุณุงููุงุช ูุฑุญุจ ุจูุง!*

### ุงูููุงุท ุงูุฑุฆูุณูุฉ ููุธุงู ุงูุฅุถุงูุงุช:
1. **ุชุนุฑูู ุงูุฅุถุงูุงุช**: ุงูุฅุถุงูุงุช ูู ูุฆุงุช Python ุงูุชู ุชุฑุซ ูู ุงููุฆุฉ ุงูุฃุณุงุณูุฉ `Plugin`.
2. **ุชุณุฌูู ุงูุฅุถุงูุงุช**: ูุชู ุชุณุฌูู ุงูุฅุถุงูุงุช ุงููุชุงุญุฉ ูู ูุงููุณ `ALL_PLUGINS`.
3. **ุชุญุฏูุฏ ุงูุฅุถุงูุงุช**: ูุชู ุฑุจุท ุงูุฅุถุงูุงุช ุจู `Agent.sandbox_plugins: list[PluginRequirement]`. ูููู ูููุณุชุฎุฏููู ุชุญุฏูุฏ ุงูุฅุถุงูุงุช ุงูุชู ูุฌุจ ุชุญููููุง ุนูุฏ ุชููุฆุฉ ุงูุจูุฆุฉ.
4. **ุชููุฆุฉ ุงูุฅุถุงูุงุช**: ูุชู ุชููุฆุฉ ุงูุฅุถุงูุงุช ุจุดูู ุบูุฑ ูุชุฒุงูู ุนูุฏ ุจุฏุก ุชุดุบูู ุงูุนููู.
5. **ุงุณุชุฎุฏุงู ุงูุฅุถุงูุงุช**: ูููู ููุนููู runtime ุงุณุชุฎุฏุงู ุงูุฅุถุงูุงุช ุงูุชู ุชู ุชููุฆุชูุง ูุชูุณูุน ูุฏุฑุงุชู (ูุซู ุฅุถุงูุฉ JupyterPlugin ูุชุดุบูู ุฎูุงูุง IPython).