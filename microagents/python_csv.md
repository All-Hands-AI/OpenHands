---
name: Python CSV Operations
description: Provides guidance and common patterns for reading, writing, and processing CSV files in Python.
triggers:
  keywords:
    - csv
    - python csv
    - read csv
    - write csv
    - pandas csv
    - process csv
    - parse csv
# file_patterns: # Not specific to file patterns, but rather keywords
#  - "*.csv" # This might be too broad or not the primary trigger mechanism desired here
version: 1.0
type: knowledge # Explicitly defining as a knowledge agent
---

## Working with CSV Files in Python

Comma-Separated Values (CSV) files are a common way to store tabular data. Python offers several ways to work with them, primarily through the built-in `csv` module and the powerful `pandas` library.

### Using the `csv` Module (Built-in)

The `csv` module is suitable for basic CSV operations, especially when you don't need complex data manipulation or analysis capabilities.

**Reading CSV Files:**

```python
import csv

# Example: Reading a CSV file
with open('your_file.csv', mode='r', newline='', encoding='utf-8') as file:
    csv_reader = csv.reader(file, delimiter=',') # Common delimiters: ',', ';', '\t'

    # Reading header (optional)
    header = next(csv_reader, None)
    if header:
        print(f"Header: {header}")

    # Iterating over rows
    for row in csv_reader:
        # Each row is a list of strings
        print(row)
        # Example: print(f"Column 1: {row[0]}, Column 2: {row[1]}")

# Reading as dictionaries (header row used as keys)
with open('your_file.csv', mode='r', newline='', encoding='utf-8') as file:
    csv_reader = csv.DictReader(file)
    for row_dict in csv_reader:
        # Each row is a dictionary
        print(row_dict)
        # Example: print(f"Name: {row_dict['Name']}, Age: {row_dict['Age']}")
```

**Writing CSV Files:**

```python
import csv

# Example: Writing data to a CSV file
header = ['name', 'age', 'city']
data = [
    ['Alice', 30, 'New York'],
    ['Bob', 24, 'Paris'],
    ['Charlie', 28, 'London']
]

with open('output.csv', mode='w', newline='', encoding='utf-8') as file:
    csv_writer = csv.writer(file, delimiter=',', quotechar='"', quoting=csv.QUOTE_MINIMAL)

    csv_writer.writerow(header) # Write the header
    csv_writer.writerows(data)  # Write multiple data rows
    # Or write row by row:
    # for row in data:
    #     csv_writer.writerow(row)

print("Data written to output.csv")
```

**Common `csv.reader` and `csv.writer` parameters:**
*   `delimiter`: The character used to separate fields (e.g., `,`, `;`, `\t`).
*   `quotechar`: The character used to quote fields containing special characters (like the delimiter or newline).
*   `quoting`: Controls when quotes should be generated by the writer and recognized by the reader. `csv.QUOTE_MINIMAL` is common.

### Using the `pandas` Library

For more advanced data analysis, manipulation, or when working with larger datasets, the `pandas` library is highly recommended.

**Reading CSV Files with `pandas`:**

```python
import pandas as pd

# Example: Reading a CSV file into a DataFrame
try:
    df = pd.read_csv('your_file.csv', encoding='utf-8') # pandas auto-detects delimiter often

    # Print the first 5 rows
    print(df.head())

    # Access columns
    # print(df['column_name'])

    # Iterate over rows (less common for pandas, usually use vectorized operations)
    # for index, row in df.iterrows():
    #     print(row['column1'], row['column2'])

except FileNotFoundError:
    print("Error: The file your_file.csv was not found.")
except pd.errors.EmptyDataError:
    print("Error: The CSV file is empty.")
except Exception as e:
    print(f"An error occurred: {e}")
```

**Writing CSV Files with `pandas`:**

```python
import pandas as pd

# Example: Creating a DataFrame and writing to CSV
data = {'name': ['Alice', 'Bob'], 'age': [30, 24]}
df = pd.DataFrame(data)

df.to_csv('output_pandas.csv', index=False, encoding='utf-8') # index=False prevents writing DataFrame index as a column
print("Data written to output_pandas.csv using pandas")
```

**Why use `pandas`?**
*   Handles large files more efficiently.
*   Provides powerful data structures (DataFrame, Series).
*   Offers extensive data cleaning, transformation, and analysis functions.
*   Simpler syntax for common operations like filtering, grouping, merging.

### Common Tips & Pitfalls

*   **`newline=''`**: When opening CSV files for the `csv` module, always use `newline=''` to correctly handle different line endings (`\r\n`, `\n`). `pandas` usually handles this automatically.
*   **Encoding**: UTF-8 (`encoding='utf-8'`) is a common and good default, but CSV files can come in various encodings. If you see garbled text, you might need to determine the correct encoding (e.g., 'latin1', 'iso-8859-1', 'cp1252').
*   **Headers**: Be mindful of whether your CSV has a header row. `csv.DictReader` assumes the first row is the header. `pd.read_csv` also assumes this by default (`header=0`).
*   **Quoting**: CSV files can have fields quoted, especially if they contain the delimiter character or newlines. Both `csv` and `pandas` modules handle standard quoting.
*   **Large Files**: For very large CSVs that don't fit in memory, `csv` module allows row-by-row processing. `pandas.read_csv` also has a `chunksize` parameter to process files in chunks.
*   **Error Handling**: Always wrap file operations in `try...except` blocks to handle potential `FileNotFoundError`, `IOError`, or parsing errors gracefully.

This microagent should provide a good starting point for handling CSV files in Python.
Remember to install pandas if you choose to use it: `pip install pandas`
```
